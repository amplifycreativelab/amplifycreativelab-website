---
// src/components/perth-food-photography/PerthFoodPhotographyIntro.astro
import { Image } from "astro:assets";

// Importing multiple images for the slider
import img1 from "../../assets/images/perth-food-photography/professional-food-photography-steak-menu.webp";
import img2 from "../../assets/images/perth-food-photography/lifestyle-food-photography-pasta-perth.webp";
import img3 from "../../assets/images/perth-food-photography/restaurant-interior-photography-open-kitchen.webp";
import img4 from "../../assets/images/perth-food-photography/gourmet-seafood-risotto-photography-perth.webp";
import img5 from "../../assets/images/perth-food-photography/social-media-food-photography-marketing.webp";
import img6 from "../../assets/images/perth-food-photography/candid-dining-portrait-pizza-perth.webp";
import img7 from "../../assets/images/perth-food-photography/perth-event-photographer-nye-celebration.webp";
import img8 from "../../assets/images/perth-food-photography/family-dining-photography-seafood-wa.webp";
import img9 from "../../assets/images/perth-food-photography/candid-event-photography-perth-restaurant.webp";

// Image collection for the slider with Alt Text
const images = [
  {
    src: img1,
    alt: "High-contrast close-up of a steak being cut, professional menu photography for Perth steakhouses.",
  },
  {
    src: img2,
    alt: "Diner enjoying clam pasta, bright lifestyle photography suitable for Italian restaurant web design in Perth.",
  },
  {
    src: img3,
    alt: "Wide angle shot of a busy Perth restaurant interior with an open kitchen, high-quality asset for venue website development.",
  },
  {
    src: img4,
    alt: "Detailed shot of prawn risotto, professional food styling and photography for fine dining menus in Perth.",
  },
  {
    src: img5,
    alt: "Behind-the-scenes of smartphone food photography, showcasing content creation services for Perth restaurant marketing.",
  },
  {
    src: img6,
    alt: "Candid portrait of a woman eating pizza, authentic lifestyle photography for restaurant branding and web design.",
  },
  {
    src: img7,
    alt: "Guests celebrating New Year's Eve 2025 with champagne, captured by a professional Perth event photographer.",
  },
  {
    src: img8,
    alt: "Smiling child eating mussels, capturing family-friendly dining atmosphere for Western Australia hospitality venues.",
  },
  {
    src: img9,
    alt: "Candid shot of a woman smiling at a dinner event, capturing the atmosphere for Perth hospitality website design.",
  },
];
---

<section class="food-intro">
  <div class="food-intro__text-container">
    <span class="food-intro__subtitle">CONTENT CREATION</span>
    <h1 class="food-intro__title">
      Elevate Your Restaurant with Captivating Visual Content
    </h1>

    <div class="food-intro__description">
      <p class="food-intro__text-highlight">
        Don't underestimate the power of visuals. Engaging content is the key to
        unlocking your restaurant's full potential.
      </p>

      <p class="food-intro__text">
        Transform your culinary creations into mouth-watering visual
        experiences. From capturing the sizzle of a perfectly cooked steak to
        showcasing the vibrant colors of a fresh salad, we bring your menu to
        life with our photography and videography services.
      </p>

      <p class="food-intro__text">
        We believe every restaurant has a unique story to tell. Let us help you
        craft that story with engaging visuals that resonate with your audience
        and expand your restaurant's reach.
      </p>
    </div>
  </div>

  <div class="food-intro__slider-container">
    {
      images.map((img, index) => (
        <div class="food-intro__slide">
          <Image
            src={img.src}
            alt={img.alt}
            width={600}
            height={600}
            class="food-intro__image"
          />
        </div>
      ))
    }
  </div>
</section>

<style>
  :root {
    --text-color: #fef8eb;
    --bg-color-dark: #3e2b22;
  }

  .food-intro {
    background-color: var(--bg-color-dark);
    color: var(--text-color);
    padding: 80px 0 0 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    overflow: hidden;
  }

  .food-intro__text-container {
    max-width: 1000px;
    padding: 0 20px 60px 20px;
    margin: 0 auto;
  }

  .food-intro__subtitle {
    font-family: "Darker Grotesque", sans-serif;
    font-size: 14px;
    letter-spacing: 2px;
    text-transform: uppercase;
    display: block;
    margin-bottom: 20px;
    opacity: 0.9;
  }

  .food-intro__title {
    font-family: "Abril Fatface", serif;
    font-size: 48px;
    font-weight: 500;
    line-height: 1.2;
    margin: 0 0 30px 0;
    color: var(--text-color);
  }

  .food-intro__description {
    display: flex;
    flex-direction: column;
    gap: 20px;
    max-width: 900px;
    margin: 0 auto;
  }

  .food-intro__text-highlight {
    font-family: "Darker Grotesque", sans-serif;
    font-size: 18px;
    font-weight: 600;
    font-style: italic;
    line-height: 1.5;
    opacity: 0.9;
    margin: 0;
  }

  .food-intro__text {
    font-family: "Darker Grotesque", sans-serif;
    font-size: 16px;
    font-weight: 400;
    line-height: 1.6;
    margin: 0;
    opacity: 0.85;
    font-style: italic;
  }

  /* Slider Styles */
  .food-intro__slider-container {
    width: 100%;
    margin-top: 20px;
    display: flex;
    overflow-x: auto;
    /* Hide scrollbar for cleaner look */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE/Edge */
    /* Enhance scrolling on touch devices */
    -webkit-overflow-scrolling: touch;
    cursor: grab; /* Indicate draggable */
    user-select: none; /* Prevent text selection while dragging */
  }

  .food-intro__slider-container:active {
    cursor: grabbing;
  }

  .food-intro__slider-container::-webkit-scrollbar {
    display: none; /* Chrome/Safari/Opera */
  }

  .food-intro__slide {
    position: relative;
    /* 
       Use percentage of container width instead of viewport width.
       33.333% = 3 images visible at once on desktop.
    */
    flex: 0 0 33.333%;
    /* aspect-ratio: 1 forces a square shape based on width */
    aspect-ratio: 1 / 1;
    border-right: 1px solid rgba(255, 255, 255, 0.1);
    overflow: hidden; /* Ensure image doesn't overflow */
  }

  .food-intro__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    transition: transform 0.5s ease;
    /* Ensure aspect ratio is respected if browser fails on parent */
    aspect-ratio: 1 / 1;
  }

  .food-intro__slide:hover .food-intro__image {
    transform: scale(1.03);
  }

  @media (max-width: 1024px) {
    .food-intro__slide {
      flex: 0 0 33.33%; /* 3 on tablet */
    }
  }

  @media (max-width: 768px) {
    .food-intro__title {
      font-size: 32px;
    }

    .food-intro__slide {
      flex: 0 0 50%; /* 2 on mobile landscape / large phone */
    }
  }

  @media (max-width: 480px) {
    .food-intro__slide {
      flex: 0 0 100%; /* 1 on mobile portrait */
    }
  }
</style>

<script>
  const slider = document.querySelector(
    ".food-intro__slider-container",
  ) as HTMLElement;
  let isDown = false;
  let startX: number;
  let scrollLeft: number;
  let animationId: number;

  if (slider) {
    // Auto-scroll logic
    const autoScrollSpeed = 1; // Pixels per frame

    function startAutoScroll() {
      if (!isDown) {
        // Only auto-scroll if user isn't dragging
        slider.scrollLeft += autoScrollSpeed;

        // Loop back to start if we reached the end (approximate check)
        // Note: exact loop requires content duplication, this is a simple reset
        if (slider.scrollLeft >= slider.scrollWidth - slider.clientWidth - 1) {
          slider.scrollLeft = 0;
        }
      }
      animationId = requestAnimationFrame(startAutoScroll);
    }

    // Start auto-scroll initially
    animationId = requestAnimationFrame(startAutoScroll);

    // Stop auto-scroll on interaction
    slider.addEventListener("mouseenter", () =>
      cancelAnimationFrame(animationId),
    );
    slider.addEventListener("touchstart", () =>
      cancelAnimationFrame(animationId),
    );

    // Resume auto-scroll when interaction ends
    slider.addEventListener("mouseleave", () => {
      isDown = false;
      slider.classList.remove("active");
      cancelAnimationFrame(animationId); // Ensure no duplicate loops
      animationId = requestAnimationFrame(startAutoScroll);
    });

    slider.addEventListener("touchend", () => {
      cancelAnimationFrame(animationId);
      animationId = requestAnimationFrame(startAutoScroll);
    });

    // Drag Logic
    slider.addEventListener("mousedown", (e) => {
      isDown = true;
      slider.classList.add("active");
      startX = e.pageX - slider.offsetLeft;
      scrollLeft = slider.scrollLeft;
      cancelAnimationFrame(animationId); // Stop auto-scroll while dragging
    });

    slider.addEventListener("mouseup", () => {
      isDown = false;
      slider.classList.remove("active");
      // Resumed by mouseleave if cursor leaves, or we could resume here if cursor stays
      // But typically mouseleave handles the "done interacting" best for desktop
    });

    slider.addEventListener("mousemove", (e) => {
      if (!isDown) return;
      e.preventDefault();
      const x = e.pageX - slider.offsetLeft;
      const walk = (x - startX) * 2; // Scroll-fast
      slider.scrollLeft = scrollLeft - walk;
    });
  }
</script>
