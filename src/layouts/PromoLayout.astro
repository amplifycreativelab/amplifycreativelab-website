---
import CookieConsent from "../components/CookieConsent.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import logoAsset from "../assets/images/logo/amplify-creative-lab-logo-perth-WA.svg";
import appleTouchIcon from "../assets/favicons/apple-touch-icon.png";

import favicon32 from "../assets/favicons/favicon-32x32.png";
import msTileImage from "../assets/favicons/mstile-270x270.png";
import "../styles/main.css";

// Fonts
import "../styles/fonts.css";

const businessDescription =
    "Amplify Creative Lab is a Perth-based food photography and creative studio for hospitality brands and venues.";

const {
    title = "Free Website Design Offer | Amplify Creative Lab",
    description = businessDescription,
    noIndex = false, // Default to false as per request (must be indexed)
    noFollow = false,
    canonical: canonicalProp,
    ogTitle,
    ogDescription,
    ogImage,
    ogImageAlt,
    ogType,
} = Astro.props;

const siteUrl = "https://amplifycreativelab.com";
const canonical =
    canonicalProp ?? new URL(Astro.url.pathname, siteUrl).toString();
const GA_MEASUREMENT_ID = "GT-WBZNSN3B";
const GOOGLE_ADS_ID = "AW-17539052212";

const logoUrl = new URL(logoAsset.src, siteUrl).toString();

const toAbsoluteUrl = (value: string) => {
    try {
        return new URL(value, siteUrl).toString();
    } catch {
        return value;
    }
};

const resolvedOgType = ogType ?? "website";
const resolvedOgTitle = ogTitle ?? title;
const resolvedOgDescription = ogDescription ?? description;
const defaultSocialImage = `${siteUrl}/images/logo/amplify-creative-lab-logo-email-compressed.jpg`;
const resolvedOgImage = toAbsoluteUrl(ogImage ?? defaultSocialImage);
const resolvedOgImageAlt =
    ogImageAlt ??
    "Amplify Creative Lab â€“ Perth food photography logo and branding";

const baseSchema = {
    "@context": "https://schema.org",
    "@graph": [
        {
            "@type": "WebSite",
            "@id": `${siteUrl}/#website`,
            url: siteUrl,
            name: "Amplify Creative Lab",
            description: businessDescription,
            publisher: {
                "@id": `${siteUrl}/#organization`,
            },
            inLanguage: "en-AU",
        },
        {
            "@type": "WebPage",
            "@id": canonical,
            url: canonical,
            name: title,
            description: description,
            isPartOf: {
                "@id": `${siteUrl}/#website`,
            },
            about: {
                "@id": `${siteUrl}/#organization`,
            },
            creator: {
                "@id": `${siteUrl}/#organization`,
            },
            publisher: {
                "@id": `${siteUrl}/#organization`,
            },
            inLanguage: "en-AU",
        },
        {
            "@type": "Organization",
            "@id": `${siteUrl}/#organization`,
            name: "Amplify Creative Lab",
            url: siteUrl,
            logo: {
                "@type": "ImageObject",
                url: logoUrl,
            },
        },
    ],
};
---

<!doctype html>
<html lang="en-AU">
    <head>
        <!-- Google tag (gtag.js) -->
        <script
            async
            src={`https://www.googletagmanager.com/gtag/js?id=${GOOGLE_ADS_ID}`}
        ></script>
        <script define:vars={{ GA_MEASUREMENT_ID, GOOGLE_ADS_ID }}>
            window.dataLayer = window.dataLayer || [];
            window.gtag =
                window.gtag ||
                function () {
                    window.dataLayer.push(arguments);
                };

            window.gtag("js", new Date());
            window.gtag("config", GOOGLE_ADS_ID);
            window.gtag("config", GA_MEASUREMENT_ID);
        </script>
        <slot name="head" />

        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, viewport-fit=cover"
        />

        <link
            rel="preload"
            href="/fonts/montserrat-latin-300-normal.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />
        <link
            rel="preload"
            href="/fonts/montserrat-latin-400-normal.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />
        <link
            rel="preload"
            href="/fonts/montserrat-latin-600-normal.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />
        <link
            rel="preload"
            href="/fonts/abril-fatface-latin-400-normal.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />

        <title>{title}</title>
        {description && <meta name="description" content={description} />}

        <meta name="robots" content="index, follow" />

        <link rel="canonical" href={canonical} />

        <meta property="og:type" content={resolvedOgType} />
        <meta property="og:locale" content="en_AU" />
        <meta property="og:site_name" content="AmplifyCreativeLab" />
        <meta property="og:title" content={resolvedOgTitle} />
        {
            resolvedOgDescription && (
                <meta
                    property="og:description"
                    content={resolvedOgDescription}
                />
            )
        }
        <meta property="og:url" content={canonical} />
        <meta property="og:image" content={resolvedOgImage} />
        <meta property="og:image:alt" content={resolvedOgImageAlt} />

        <!-- Twitter Card meta tags -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="@amplifycreativelab" />
        <meta name="twitter:title" content={resolvedOgTitle} />
        <meta name="twitter:image" content={resolvedOgImage} />

        <link rel="icon" href="/favicon.ico" sizes="any" type="image/x-icon" />
        <link
            rel="icon"
            href="/favicon-192.png"
            sizes="192x192"
            type="image/png"
        />
        <link rel="icon" href={favicon32.src} sizes="32x32" type="image/png" />
        <link
            rel="apple-touch-icon"
            href={appleTouchIcon.src}
            sizes="180x180"
        />
        <meta name="msapplication-TileImage" content={msTileImage.src} />

        <meta name="theme-color" content="#FEF8EB" />

        <script
            type="application/ld+json"
            set:html={JSON.stringify(baseSchema)}
        />

        <style></style>
    </head>

    <body>
        <Header />

        <slot />

        <Footer />

        <CookieConsent />

        <script src="/js/main.js" defer></script>
    </body>
</html>
