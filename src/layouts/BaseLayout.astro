---
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import CookieConsent from "../components/CookieConsent.astro";
import logoAsset from "../assets/images/logo/amplify-creative-lab-logo-perth-WA.svg";
import appleTouchIcon from "../assets/favicons/apple-touch-icon.png";
import favicon180 from "../assets/favicons/favicon-180x180.png";

import favicon32 from "../assets/favicons/favicon-32x32.png";
import msTileImage from "../assets/favicons/mstile-270x270.png";
import "../styles/main.css";

// Fonts
import "../styles/fonts.css";

const businessDescription =
    "Amplify Creative Lab is a Perth-based food photography and creative studio for hospitality brands and venues.";

const {
    title = "Perth Food Photographer | AmplifyCreativeLab",
    description = businessDescription,
    noIndex = false,
    noFollow = false,
    canonical: canonicalProp,
    ogTitle,
    ogDescription,
    ogImage,
    ogImageAlt,
    ogType,
} = Astro.props;

const siteUrl = "https://amplifycreativelab.com";
const canonical =
    canonicalProp ?? new URL(Astro.url.pathname, siteUrl).toString();
const GA_MEASUREMENT_ID = "G-4KRYBTPCTN";
const GOOGLE_ADS_ID = "AW-17539052212";

const logoUrl = new URL(logoAsset.src, siteUrl).toString();

const toAbsoluteUrl = (value: string) => {
    try {
        return new URL(value, siteUrl).toString();
    } catch {
        return value;
    }
};

const resolvedOgType = ogType ?? "website";
const resolvedOgTitle = ogTitle ?? title;
const resolvedOgDescription = ogDescription ?? description;
const defaultSocialImage = `${siteUrl}/images/social/share-default.png`;
const resolvedOgImage = toAbsoluteUrl(ogImage ?? defaultSocialImage);
const resolvedOgImageAlt =
    ogImageAlt ??
    "Amplify Creative Lab – Perth food photography logo and branding";

const areasServed = [
    {
        "@type": "AdministrativeArea",
        name: "Western Australia",
        sameAs: "https://en.wikipedia.org/wiki/Western_Australia",
    },
    {
        "@type": "AdministrativeArea",
        name: "Perth metropolitan area",
        sameAs: "https://en.wikipedia.org/wiki/Perth_metropolitan_area",
    },
    { "@type": "City", name: "Perth", sameAs: "https://en.wikipedia.org/wiki/Perth" },
    { "@type": "City", name: "Fremantle", sameAs: "https://en.wikipedia.org/wiki/Fremantle" },
    {
        "@type": "City",
        name: "Joondalup",
        sameAs: "https://en.wikipedia.org/wiki/Joondalup,_Western_Australia",
    },
    { "@type": "City", name: "Mandurah", sameAs: "https://en.wikipedia.org/wiki/Mandurah" },

    { "@type": "Place", name: "Perth CBD" },
    { "@type": "Place", name: "West Perth" },
    { "@type": "Place", name: "East Perth" },
    { "@type": "Place", name: "Northbridge" },
    { "@type": "Place", name: "Highgate" },
    { "@type": "Place", name: "North Perth" },
    { "@type": "Place", name: "Leederville" },
    { "@type": "Place", name: "West Leederville" },
    { "@type": "Place", name: "Mount Lawley" },
    { "@type": "Place", name: "Mount Hawthorn" },

    { "@type": "Place", name: "Subiaco" },
    { "@type": "Place", name: "Shenton Park" },
    { "@type": "Place", name: "Wembley" },
    { "@type": "Place", name: "Woodlands" },
    { "@type": "Place", name: "Churchlands" },
    { "@type": "Place", name: "Tuart Hill" },
    { "@type": "Place", name: "Floreat" },
    { "@type": "Place", name: "Nedlands" },
    { "@type": "Place", name: "Claremont" },
    { "@type": "Place", name: "Peppermint Grove" },
    { "@type": "Place", name: "Dalkeith" },

    { "@type": "Place", name: "Cottesloe" },
    { "@type": "Place", name: "Swanbourne" },
    { "@type": "Place", name: "Mosman Park" },
    { "@type": "Place", name: "City Beach" },
    { "@type": "Place", name: "Scarborough" },
    { "@type": "Place", name: "Trigg" },
    { "@type": "Place", name: "North Beach" },
    { "@type": "Place", name: "Karrinyup" },
    { "@type": "Place", name: "Innaloo" },
    { "@type": "Place", name: "Doubleview" },

    { "@type": "Place", name: "Osborne Park" },
    { "@type": "Place", name: "Stirling" },
    { "@type": "Place", name: "Balcatta" },
    { "@type": "Place", name: "Wembley Downs" },
    { "@type": "Place", name: "Duncraig" },
    { "@type": "Place", name: "Greenwood" },
    { "@type": "Place", name: "Warwick" },
    { "@type": "Place", name: "Kingsley" },
    { "@type": "Place", name: "Woodvale" },
    { "@type": "Place", name: "Madeley" },
    { "@type": "Place", name: "Landsdale" },

    { "@type": "Place", name: "Hillarys" },
    { "@type": "Place", name: "Sorrento" },
    { "@type": "Place", name: "Mullaloo" },
    { "@type": "Place", name: "Ocean Reef" },
    { "@type": "Place", name: "Connolly" },
    { "@type": "Place", name: "Edgewater" },
    { "@type": "Place", name: "Heathridge" },
    { "@type": "Place", name: "Currambine" },
    { "@type": "Place", name: "Kinross" },
    { "@type": "Place", name: "Iluka" },
    { "@type": "Place", name: "Burns Beach" },
    { "@type": "Place", name: "Mindarie" },
    { "@type": "Place", name: "Clarkson" },
    { "@type": "Place", name: "Butler" },
    { "@type": "Place", name: "Jindalee" },
    { "@type": "Place", name: "Quinns Rocks" },
    { "@type": "Place", name: "Alkimos" },

    { "@type": "Place", name: "Yokine" },
    { "@type": "Place", name: "Dianella" },
    { "@type": "Place", name: "Morley" },
    { "@type": "Place", name: "Noranda" },
    { "@type": "Place", name: "Malaga" },
    { "@type": "Place", name: "Beechboro" },
    { "@type": "Place", name: "Bennett Springs" },
    { "@type": "Place", name: "Ellenbrook" },
    { "@type": "Place", name: "Brabham" },
    { "@type": "Place", name: "Caversham" },
    { "@type": "Place", name: "Dayton" },
    { "@type": "Place", name: "Bayswater" },
    { "@type": "Place", name: "Maylands" },
    { "@type": "Place", name: "Inglewood" },
    { "@type": "Place", name: "Bassendean" },
    { "@type": "Place", name: "Ashfield" },
    { "@type": "Place", name: "Guildford" },
    { "@type": "Place", name: "Midland" },
    { "@type": "Place", name: "Bellevue" },
    { "@type": "Place", name: "Helena Valley" },
    { "@type": "Place", name: "Kalamunda" },
    { "@type": "Place", name: "Lesmurdie" },
    { "@type": "Place", name: "Gooseberry Hill" },
    { "@type": "Place", name: "Mundaring" },
    { "@type": "Place", name: "Roleystone" },
    { "@type": "Place", name: "Darlington" },
    { "@type": "Place", name: "Glen Forrest" },

    { "@type": "Place", name: "Belmont" },
    { "@type": "Place", name: "Rivervale" },
    { "@type": "Place", name: "Burswood" },
    { "@type": "Place", name: "Victoria Park" },
    { "@type": "Place", name: "East Victoria Park" },
    { "@type": "Place", name: "Como" },
    { "@type": "Place", name: "South Perth" },
    { "@type": "Place", name: "Manning" },
    { "@type": "Place", name: "Waterford" },

    { "@type": "Place", name: "Applecross" },
    { "@type": "Place", name: "Mount Pleasant" },
    { "@type": "Place", name: "Ardross" },
    { "@type": "Place", name: "Attadale" },
    { "@type": "Place", name: "Bicton" },
    { "@type": "Place", name: "Palmyra" },
    { "@type": "Place", name: "East Fremantle" },
    { "@type": "Place", name: "South Fremantle" },
    { "@type": "Place", name: "North Fremantle" },
    { "@type": "Place", name: "White Gum Valley" },
    { "@type": "Place", name: "Beaconsfield" },
    { "@type": "Place", name: "Hamilton Hill" },
    { "@type": "Place", name: "Hilton" },

    { "@type": "Place", name: "Myaree" },
    { "@type": "Place", name: "Booragoon" },
    { "@type": "Place", name: "Bull Creek" },
    { "@type": "Place", name: "Murdoch" },
    { "@type": "Place", name: "Winthrop" },
    { "@type": "Place", name: "Leeming" },
    { "@type": "Place", name: "Willetton" },
    { "@type": "Place", name: "Rossmoyne" },
    { "@type": "Place", name: "Shelley" },
    { "@type": "Place", name: "Harrisdale" },

    { "@type": "Place", name: "Canning Vale" },
    { "@type": "Place", name: "Cannington" },
    { "@type": "Place", name: "Bentley" },
    { "@type": "Place", name: "Welshpool" },
    { "@type": "Place", name: "Thornlie" },
    { "@type": "Place", name: "Lynwood" },
    { "@type": "Place", name: "Parkwood" },
    { "@type": "Place", name: "Riverton" },
    { "@type": "Place", name: "Gosnells" },
    { "@type": "Place", name: "Kelmscott" },
    { "@type": "Place", name: "Armadale" },

    { "@type": "Place", name: "Cockburn Central" },
    { "@type": "Place", name: "Success" },
    { "@type": "Place", name: "Atwell" },
    { "@type": "Place", name: "Aubin Grove" },
    { "@type": "Place", name: "Jandakot" },
    { "@type": "Place", name: "Kwinana" },
    { "@type": "Place", name: "Rockingham" },
    { "@type": "Place", name: "Safety Bay" },
    { "@type": "Place", name: "Secret Harbour" },
    { "@type": "Place", name: "Swan Valley" },
    { "@type": "Place", name: "Perth Hills" },
    { "@type": "Place", name: "Rottnest Island" },
    { "@type": "Place", name: "Busselton" },
    { "@type": "Place", name: "Dunsborough" },
    { "@type": "Place", name: "Margaret River" },
    { "@type": "Place", name: "Bunbury" },
];

const businessSchema = {
    "@context": "https://schema.org",
    "@graph": [
        {
            "@type": ["Organization", "LocalBusiness", "ProfessionalService"],
            "@id": `${siteUrl}/#organization`,
            name: "Amplify Creative Lab",
            url: siteUrl,
            description: businessDescription,
            image: {
                "@type": "ImageObject",
                url: logoUrl,
            },
            logo: {
                "@type": "ImageObject",
                url: logoUrl,
            },
            email: "support@amplifycreativelab.com",
            telephone: "+61 460 526 441",
            address: {
                "@type": "PostalAddress",
                streetAddress: "Unit 6, 186-190 Grand Promenade",
                addressLocality: "Doubleview",
                addressRegion: "WA",
                postalCode: "6018",
                addressCountry: "AU",
            },
            areaServed: areasServed,
            geo: {
                "@type": "GeoCoordinates",
                latitude: -31.9001,
                longitude: 115.7823,
            },
            knowsAbout: [
                "Food photography",
                "Product photography",
                "Event photography",
                "Website development",
            ],
            sameAs: [
                "https://www.facebook.com/amplifycreativelab/",
                "https://au.pinterest.com/amplifycreativelab/",
                "https://www.instagram.com/amplify_creativelab/",
                "https://youtube.com/@amplifycreativelab?si=sQj7YEFQ4Towy1kM",
            ],
            makesOffer: [
                {
                    "@type": "Offer",
                    itemOffered: {
                        "@id": `${siteUrl}/#service-food-photography`,
                    },
                },
                {
                    "@type": "Offer",
                    itemOffered: {
                        "@id": `${siteUrl}/#service-product-photography`,
                    },
                },
                {
                    "@type": "Offer",
                    itemOffered: {
                        "@id": `${siteUrl}/#service-event-photography`,
                    },
                },
                {
                    "@type": "Offer",
                    itemOffered: {
                        "@id": `${siteUrl}/#service-website-development`,
                    },
                },
            ],
        },
        {
            "@type": "Service",
            "@id": `${siteUrl}/#service-food-photography`,
            name: "Food Photography",
            serviceType: "Food Photography",
            description:
                "Professional food photography for Perth restaurants, cafés, bars and hospitality brands. Menu imagery, styled hero dishes, Uber Eats and delivery platform photos.",
            areaServed: areasServed,
            provider: {
                "@id": `${siteUrl}/#organization`,
            },
            url: `${siteUrl}/perth-food-photography/`,
            priceRange: "$$$",
        },
        {
            "@type": "Service",
            "@id": `${siteUrl}/#service-event-photography`,
            name: "Event Photography",
            serviceType: "Event Photography",
            description:
                "Perth event photography for corporate functions, brand activations, hospitality events and private celebrations. Candid, story-driven imagery for marketing and social media.",
            areaServed: areasServed,
            provider: {
                "@id": `${siteUrl}/#organization`,
            },
            url: `${siteUrl}/perth-event-photography/`,
            priceRange: "$$$",
        },
        {
            "@type": "Service",
            "@id": `${siteUrl}/#service-product-photography`,
            name: "Product Photography",
            serviceType: "Product Photography",
            description:
                "Product photography for Perth ecommerce and retail brands. Studio packshots, lifestyle imagery for Shopify, Amazon, Etsy and marketing campaigns.",
            areaServed: areasServed,
            provider: {
                "@id": `${siteUrl}/#organization`,
            },
            url: `${siteUrl}/perth-product-photography/`,
            priceRange: "$$$",
        },
        {
            "@type": "Service",
            "@id": `${siteUrl}/#service-website-development`,
            name: "Website Development",
            serviceType: "Website Development",
            description:
                "Custom website design and development for Perth businesses, sole traders and hospitality venues. Fast, SEO-friendly, mobile-responsive sites from $400.",
            areaServed: areasServed,
            provider: {
                "@id": `${siteUrl}/#organization`,
            },
            url: `${siteUrl}/perth-website-development/`,
            priceRange: "$$",
        },
        {
            "@type": "Person",
            "@id": `${siteUrl}/#person-jojo`,
            name: "Jojo",
            jobTitle: "Food, product and event photographer",
            worksFor: { "@id": `${siteUrl}/#organization` },
            homeLocation: {
                "@type": "Place",
                name: "Doubleview, Western Australia",
            },
        },
        {
            "@type": "Person",
            "@id": `${siteUrl}/#person-stefano`,
            name: "Stefano",
            jobTitle: "Web developer and technical strategist",
            worksFor: { "@id": `${siteUrl}/#organization` },
        },
    ],
};
---

<!doctype html>
<html lang="en-AU">
    <head>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, viewport-fit=cover"
        />

        <link
            rel="preload"
            href="/fonts/montserrat-latin-300-normal.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />
        <link
            rel="preload"
            href="/fonts/montserrat-latin-400-normal.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />
        <link
            rel="preload"
            href="/fonts/montserrat-latin-600-normal.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />
        <link
            rel="preload"
            href="/fonts/abril-fatface-latin-400-normal.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />

        <title>{title}</title>
        {description && <meta name="description" content={description} />}

        {
            noIndex ? (
                <meta
                    name="robots"
                    content={`noindex, ${noFollow ? "nofollow" : "follow"}`}
                />
            ) : (
                <meta
                    name="robots"
                    content="index, follow, max-snippet:-1, max-video-preview:-1, max-image-preview:large"
                />
            )
        }

        <link rel="canonical" href={canonical} />

        <meta property="og:type" content={resolvedOgType} />
        <meta property="og:locale" content="en_AU" />
        <meta property="og:site_name" content="AmplifyCreativeLab" />
        <meta property="og:title" content={resolvedOgTitle} />
        {
            resolvedOgDescription && (
                <meta
                    property="og:description"
                    content={resolvedOgDescription}
                />
            )
        }
        <meta property="og:url" content={canonical} />
        <meta property="og:image" content={resolvedOgImage} />
        <meta property="og:image:alt" content={resolvedOgImageAlt} />
        <!--
    <meta
  property="og:image"
  content={`${siteUrl}/images/social/share-default.png`}
/>
    <meta
  property="og:image:alt"
  content="Amplify Creative Lab – Perth food photography logo and branding"
/>
        -->

        <!-- Twitter Card meta tags -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="@amplifycreativelab" />
        <meta name="twitter:title" content={resolvedOgTitle} />
        {
            resolvedOgDescription && (
                <meta
                    name="twitter:description"
                    content={resolvedOgDescription}
                />
            )
        }
        <meta name="twitter:image" content={resolvedOgImage} />
        <meta name="twitter:image:alt" content={resolvedOgImageAlt} />
        <!--
        <meta name="twitter:image" content={`${siteUrl}/images/social/share-default.png`} />
        <meta name="twitter:image:alt" content="Amplify Creative Lab – Perth food photography logo and branding" />

        -->

        <link rel="icon" href="/favicon.ico" sizes="any" type="image/x-icon" />
        <link rel="icon" href={favicon32.src} sizes="32x32" type="image/png" />
        <link
            rel="icon"
            href={favicon180.src}
            sizes="180x180"
            type="image/png"
        />
        <link
            rel="icon"
            href="/favicon-192.png"
            sizes="192x192"
            type="image/png"
        />
        <link
            rel="apple-touch-icon"
            href={appleTouchIcon.src}
            sizes="180x180"
        />
        <meta name="msapplication-TileImage" content={msTileImage.src} />

        <meta name="theme-color" content="#FEF8EB" />

        <script
            type="application/ld+json"
            set:html={JSON.stringify(businessSchema)}
        />

        <script define:vars={{ GA_MEASUREMENT_ID, GOOGLE_ADS_ID }}>
            // Initialize dataLayer immediately so events can be queued
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag("js", new Date());
            gtag("config", GA_MEASUREMENT_ID);
            gtag("config", GOOGLE_ADS_ID); // Google Ads for conversion tracking

            // Lazy load GTM script
            function loadGTM() {
                if (window.gtmLoaded) return;
                window.gtmLoaded = true;

                const script = document.createElement("script");
                script.src = `https://www.googletagmanager.com/gtag/js?id=${GA_MEASUREMENT_ID}`;
                script.async = true;
                document.head.appendChild(script);
            }

            // Load on user interaction
            const events = [
                "mousedown",
                "mousemove",
                "keydown",
                "scroll",
                "touchstart",
            ];
            events.forEach((event) => {
                window.addEventListener(event, loadGTM, {
                    once: true,
                    passive: true,
                });
            });

            // Fallback: load after 4 seconds if no interaction
            setTimeout(loadGTM, 4000);
        </script>
    </head>

    <body>
        <Header />

        <slot />

        <Footer />

        <CookieConsent />

        <script src="/js/main.js" defer></script>
    </body>
</html>
